import{d as b,O as w,a2 as A,m as v,e as r,u as e,av as M,U as C,h as s,g as l,N as $,aw as R,al as E,am as O,ax as W,ay as q,az as I,a6 as G,aA as J,k as S,r as y,c as V,o as K,a as x,f,F as Q,n as X,q as Y,i as p,t as k,b as Z,p as ee}from"./DW3SVq1p.js";import{e as B,D as te,_ as P,a as ae}from"./Cv5foL5a.js";import{S as se}from"./Cf2i4mGW.js";import{E as oe}from"./BeFyUl0g.js";import{_ as F,a as le,b as N}from"./DHqhx6bH.js";const ne=b({__name:"Checkbox",props:{defaultValue:{type:[Boolean,String]},modelValue:{type:[Boolean,String,null]},disabled:{type:Boolean},value:{},id:{},asChild:{type:Boolean},as:{},name:{},required:{type:Boolean},class:{}},emits:["update:modelValue"],setup(d,{emit:o}){const n=d,u=o,c=w(n,"class"),_=A(c,u);return(g,h)=>(r(),v(e(M),C({"data-slot":"checkbox"},e(_),{class:e(B)("peer border-input data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",n.class)}),{default:s(m=>[l(e(W),{"data-slot":"checkbox-indicator",class:"grid place-content-center text-current transition-none"},{default:s(()=>[$(g.$slots,"default",E(O(m)),()=>[l(e(R),{class:"size-3.5"})])]),_:2},1024)]),_:3},16,["class"]))}}),ie=b({__name:"Tabs",props:{defaultValue:{},orientation:{},dir:{},activationMode:{},modelValue:{},unmountOnHide:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["update:modelValue"],setup(d,{emit:o}){const n=d,u=o,c=w(n,"class"),_=A(c,u);return(g,h)=>(r(),v(e(q),C({"data-slot":"tabs"},e(_),{class:e(B)("flex flex-col gap-2",n.class)}),{default:s(m=>[$(g.$slots,"default",E(O(m)))]),_:3},16,["class"]))}}),re=b({__name:"TabsList",props:{loop:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(d){const o=d,n=w(o,"class");return(u,c)=>(r(),v(e(I),C({"data-slot":"tabs-list"},e(n),{class:e(B)("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",o.class)}),{default:s(()=>[$(u.$slots,"default")]),_:3},16,["class"]))}}),T=b({__name:"TabsTrigger",props:{value:{},disabled:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(d){const o=d,n=w(o,"class"),u=G(n);return(c,_)=>(r(),v(e(J),C({"data-slot":"tabs-trigger",class:e(B)("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",o.class)},e(u)),{default:s(()=>[$(c.$slots,"default")]),_:3},16,["class"]))}});async function de(d){return S("/api/wishes",{method:"POST",body:d})}async function U(d,o){return S(`/api/wishes/${d}`,{method:"PATCH",body:o})}const ue={class:"min-h-screen bg-gradient-to-br from-slate-50 via-slate-50/50 to-slate-50 dark:from-slate-900 dark:via-slate-900/50 dark:to-slate-900"},ce={class:"max-w-3xl mx-auto px-4 py-6 space-y-4"},fe={class:"flex flex-col gap-3 sm:flex-row sm:items-center sm:justify-between"},me={class:"text-sm text-muted-foreground text-center sm:text-left"},pe={key:0},ve={key:1},_e={key:2,class:"space-y-3"},ge={class:"flex items-start gap-3 flex-1 min-w-0"},xe={class:"flex-1 min-w-0"},be={key:0,class:"flex items-center gap-2 mt-2"},he={class:"text-xs text-muted-foreground"},ye={class:"flex-shrink-0"},Ve=b({__name:"index",setup(d){const o=y([]),n=y(""),u=y(!0),c=y("all"),_=V(()=>o.value.filter(a=>a.status==="todo")),g=V(()=>o.value.filter(a=>a.status==="done")),h=V(()=>c.value==="todo"?_.value:c.value==="done"?g.value:o.value);async function m(){u.value=!0;try{const a=await S("/api/wishes");o.value=a.items}catch(a){console.error("加载愿望列表失败:",a)}finally{u.value=!1}}K(m);async function j(){if(n.value)try{await de({title:n.value}),n.value="",await m()}catch(a){console.error("添加愿望失败:",a)}}async function z(a){try{await U(a,{status:"done"}),await m()}catch(t){console.error("标记完成失败:",t)}}async function L(a){try{await U(a,{status:"todo"}),await m()}catch(t){console.error("重置愿望失败:",t)}}async function H(a){a.status==="todo"?await z(a.id):await L(a.id)}return(a,t)=>(r(),x("div",ue,[l(te),f("div",ce,[l(e(N),null,{default:s(()=>[l(e(F),{class:"px-4"},{default:s(()=>[f("form",{class:"flex flex-col sm:flex-row gap-3 mb-4",onSubmit:Y(j,["prevent"])},[l(e(le),{modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=i=>n.value=i),placeholder:"添加一个愿望…",class:"flex-1"},null,8,["modelValue"]),l(e(P),{type:"submit",class:"sm:w-auto"},{default:s(()=>[...t[2]||(t[2]=[p("添加",-1)])]),_:1})],32),f("div",fe,[f("div",me," 共 "+k(o.value.length)+" 个愿望 · 已完成 "+k(g.value.length)+" 个 ",1),l(e(ie),{"model-value":c.value,"onUpdate:modelValue":t[1]||(t[1]=i=>c.value=i),class:"w-full sm:w-auto"},{default:s(()=>[l(e(re),{class:"grid w-full grid-cols-3"},{default:s(()=>[l(e(T),{value:"all"},{default:s(()=>[...t[3]||(t[3]=[p("全部",-1)])]),_:1}),l(e(T),{value:"todo"},{default:s(()=>[...t[4]||(t[4]=[p("未完成",-1)])]),_:1}),l(e(T),{value:"done"},{default:s(()=>[...t[5]||(t[5]=[p("已完成",-1)])]),_:1})]),_:1})]),_:1},8,["model-value"])])]),_:1})]),_:1}),u.value?(r(),x("div",pe,[l(se,{count:3})])):h.value.length===0?(r(),x("div",ve,[l(oe,{text:"还没有愿望，添加一个吧",img:"/assets/images/xiaobai/xiaobai-1.png","cta-text":"添加愿望","cta-to":"/wishes"})])):(r(),x("div",_e,[(r(!0),x(Q,null,X(h.value,i=>(r(),v(e(N),{key:i.id},{default:s(()=>[l(e(F),null,{default:s(()=>[f("div",ge,[l(e(ne),{checked:i.status==="done","onUpdate:checked":D=>H(i),class:"mt-1"},null,8,["checked","onUpdate:checked"]),f("div",xe,[f("div",{class:ee(["text-base font-medium break-words",i.status==="done"?"line-through text-muted-foreground":""])},k(i.title),3),i.status==="done"&&i.finishedAt?(r(),x("div",be,[l(e(ae),{variant:"default",class:"text-xs"},{default:s(()=>[...t[6]||(t[6]=[p("已完成",-1)])]),_:1}),f("span",he,k(new Date(i.finishedAt).toLocaleString()),1)])):Z("",!0)]),f("div",ye,[i.status==="todo"?(r(),v(e(P),{key:0,variant:"outline",size:"sm",onClick:D=>z(i.id)},{default:s(()=>[...t[7]||(t[7]=[p("标记完成",-1)])]),_:1},8,["onClick"])):(r(),v(e(P),{key:1,variant:"outline",size:"sm",onClick:D=>L(i.id)},{default:s(()=>[...t[8]||(t[8]=[p("重置",-1)])]),_:1},8,["onClick"]))])])]),_:2},1024)]),_:2},1024))),128))]))])]))}});export{Ve as default};
