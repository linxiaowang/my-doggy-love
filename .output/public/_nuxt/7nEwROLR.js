import{d as K,r as C,c as T,w as ne,o as ie,a as o,b as y,e as l,f as e,g as A,t as k,_ as ye,h as V,i as de,j as H,k as ge,l as he,S as me,m as oe,F as E,n as Z,p as P,u as re,T as ze,q as Q,s as be,v as q,x as we,y as Ye,z as Be,A as Ie,B as xe,C as pe,D as Te,E as Le,G as Ae}from"./DW3SVq1p.js";import{_ as Fe,D as Ge}from"./Cv5foL5a.js";import{u as Se}from"./Bb-vy0QT.js";const Ne={key:0,class:"card"},Pe={class:"flex items-center justify-between gap-4"},Oe={class:"flex-1 min-w-0"},Re={class:"text-base font-semibold text-text-main mb-1 truncate"},qe={class:"text-xs text-text-secondary"},Ee={class:"text-right flex-shrink-0"},Ze={key:0,class:"text-xl font-bold text-green-700 bg-green-50 px-3 py-1.5 rounded-lg whitespace-nowrap"},He={key:1,class:"text-right"},Qe={key:2,class:"text-right"},Ve=K({__name:"AnniversaryCountdown",setup(O){const w=C([]),$=C(!0),c=C("days");function j(m){const r=new Date,i=new Date(m.date),b=new Date(r.getFullYear(),r.getMonth(),r.getDate()).getTime(),x=new Date(i.getFullYear(),i.getMonth(),i.getDate()).getTime(),v=Math.round((x-b)/(1440*60*1e3));return{days:v,overdue:v<0}}function t(m){const r=new Date(m),i=r.getMonth()+1,b=r.getDate();return`${i}æœˆ${b}æ—¥`}function p(m,r,i){const b=Math.abs(m);switch(r){case"years":if(b>=365)if(i){const x=H(),v=H(i),B=Math.abs(x.diff(v,"year")),_=x.isBefore(v)?x:v,u=x.isAfter(v)?x:v,d=_.add(B,"year"),I=Math.abs(u.diff(d,"day"));return I===0?`${B}å¹´`:`${B}å¹´${I}å¤©`}else{const x=Math.floor(b/365),v=b%365;return v===0?`${x}å¹´`:`${x}å¹´${v}å¤©`}return p(m,"months",i);case"months":if(b>=30)if(i){const x=H(),v=H(i),B=Math.abs(x.diff(v,"month")),_=x.isBefore(v)?x:v,u=x.isAfter(v)?x:v,d=_.add(B,"month"),I=Math.abs(u.diff(d,"day"));return I===0?`${B}ä¸ªæœˆ`:`${B}ä¸ªæœˆ${I}å¤©`}else{const x=Math.floor(b/30),v=b%30;return v===0?`${x}ä¸ªæœˆ`:`${x}ä¸ªæœˆ${v}å¤©`}return p(m,"weeks",i);case"weeks":if(b>=7){const x=Math.floor(b/7),v=b%7;return v===0?`${x}å‘¨`:`${x}å‘¨${v}å¤©`}return p(m,"days",i);case"days":default:return`${b}å¤©`}}function f(){const m=Math.abs(g.value.days);m>=365?c.value==="days"?c.value="weeks":c.value==="weeks"?c.value="months":c.value==="months"?c.value="years":c.value="days":m>=30?c.value==="days"?c.value="weeks":c.value==="weeks"?c.value="months":c.value="days":m>=7&&(c.value==="days"?c.value="weeks":c.value="days")}const M=T(()=>g.value.days===0?"":p(g.value.days,c.value,h.value?.date)),h=T(()=>{if(w.value.length===0)return null;const m=w.value.map(i=>({anniversary:i,countdown:j(i)})).filter(i=>!i.countdown.overdue).sort((i,b)=>i.countdown.days-b.countdown.days);if(m.length>0&&m[0])return m[0].anniversary;const r=w.value.map(i=>({anniversary:i,countdown:j(i)})).filter(i=>i.countdown.overdue).sort((i,b)=>b.countdown.days-i.countdown.days);return r.length>0&&r[0]?r[0].anniversary:null}),g=T(()=>h.value?j(h.value):{days:0,overdue:!1});ne(h,()=>{c.value="days"});async function R(){$.value=!0;try{const m=await ge("/api/anniversaries");w.value=m.items||[]}catch(m){console.error("åŠ è½½çºªå¿µæ—¥å¤±è´¥:",m),w.value=[]}finally{$.value=!1}}return ie(()=>{R()}),(m,r)=>{const i=ye;return!$.value&&h.value?(l(),o("div",Ne,[e("div",Pe,[e("div",Oe,[r[0]||(r[0]=e("div",{class:"text-xs text-text-muted mb-1.5"},"çºªå¿µæ—¥æé†’",-1)),e("div",Re,k(h.value.title),1),e("div",qe,k(t(h.value.date)),1)]),e("div",Ee,[g.value.days===0?(l(),o("div",Ze," ðŸŽ‰ å°±æ˜¯ä»Šå¤©ï¼ ")):g.value.overdue?(l(),o("div",He,[r[1]||(r[1]=e("div",{class:"text-xs text-text-muted mb-0.5"},"å·²ç»",-1)),e("div",{class:"text-xl font-bold text-red-600 cursor-pointer hover:opacity-80 transition-opacity",onClick:f,title:"ç‚¹å‡»åˆ‡æ¢æ˜¾ç¤ºæ ¼å¼"},k(M.value),1)])):(l(),o("div",Qe,[r[2]||(r[2]=e("div",{class:"text-xs text-text-muted mb-0.5"},"è¿˜æœ‰",-1)),e("div",{class:"text-xl font-bold text-primary-800 cursor-pointer hover:opacity-80 transition-opacity",onClick:f,title:"ç‚¹å‡»åˆ‡æ¢æ˜¾ç¤ºæ ¼å¼"},k(M.value),1)]))])]),A(i,{to:"/anniversaries",class:"mt-3 block text-center text-xs text-text-secondary hover:text-primary-700 underline transition-colors"},{default:V(()=>[...r[3]||(r[3]=[de(" æŸ¥çœ‹æ‰€æœ‰çºªå¿µæ—¥ â†’ ",-1)])]),_:1})])):y("",!0)}}}),We=Object.assign(Ve,{__name:"AnniversaryCountdown"}),Ke={class:"bg-white dark:bg-slate-800 rounded-lg shadow-lg border-2 border-slate-900 dark:border-slate-600 overflow-hidden"},Ue={class:"flex flex-col md:flex-row"},Je={class:"flex-1 p-3 md:p-4"},Xe={class:"relative mb-4"},et={class:"flex items-start justify-between mb-3"},tt={class:"flex flex-col"},st={class:"text-xs md:text-sm text-slate-600 dark:text-slate-400 mt-1 font-medium"},at={class:"flex items-center"},lt={class:"flex items-center justify-end gap-2"},ot={class:"grid grid-cols-4 gap-2"},rt=["onClick"],nt={class:"grid grid-cols-4 gap-2"},it=["onClick"],dt={class:"w-full relative"},ut={class:"grid grid-cols-7 gap-1 mb-2"},ct={class:"grid grid-cols-7 gap-1"},vt=["onClick"],ft={key:1,class:"text-xs text-slate-600 dark:text-slate-400 whitespace-nowrap w-full text-center"},ht={key:2,class:"absolute top-1 right-1"},mt={class:"bg-white/95 dark:bg-slate-800/95 backdrop-blur-md rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto border border-slate-200 dark:border-slate-700"},xt={key:0,class:"p-4 space-y-4"},pt={class:"space-y-2"},yt={class:"text-base text-slate-900 dark:text-slate-100"},gt={key:0,class:"space-y-2"},bt={class:"text-base text-slate-900 dark:text-slate-100"},wt={key:1,class:"space-y-2"},kt={class:"text-base text-slate-900 dark:text-slate-100"},_t={key:2,class:"space-y-2"},$t={key:0,class:"mb-2"},Mt={class:"text-sm text-slate-600 dark:text-slate-400 mt-1"},Dt={key:1,class:"mb-2"},Ct={class:"text-sm text-slate-600 dark:text-slate-400 mt-1"},jt={key:3,class:"space-y-2"},zt={class:"text-base text-amber-600 dark:text-amber-500 font-semibold"},Yt={key:4,class:"space-y-2"},Bt={class:"space-y-2"},It=K({__name:"Calendar",setup(O){const w={render:()=>q("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[q("path",{d:"M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"})])},$={render:()=>q("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[q("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z"})])},c={render:()=>q("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 24 24"},[q("path",{d:"M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"})])},j=["ä¸€","äºŒ","ä¸‰","å››","äº”","å…­","æ—¥"],t=["ä¸€æœˆ","äºŒæœˆ","ä¸‰æœˆ","å››æœˆ","äº”æœˆ","å…­æœˆ","ä¸ƒæœˆ","å…«æœˆ","ä¹æœˆ","åæœˆ","åä¸€æœˆ","åäºŒæœˆ"],p=C(new Date),f=T(()=>p.value.getFullYear()),M=T(()=>p.value.getMonth()),h=C(!1),g=C(!1),R=C(null),m=C(null);he(R,()=>{h.value=!1}),he(m,()=>{g.value=!1});const r=C(null),i=C(!1),{data:b}=Se(),x=T(()=>b.value?.items||[]),v=T(()=>{const a=new Map;return x.value.forEach(s=>{const D=H(s.date).format("YYYY-MM-DD");a.has(D)||a.set(D,[]),a.get(D).push(s)}),a}),B=T(()=>{const a=new Date;return f.value===a.getFullYear()&&M.value===a.getMonth()}),_=T(()=>{try{const s=me.fromYmd(f.value,M.value+1,1).getLunar(),D=s.getYearInGanZhi(),n=s.getYearShengXiao();return`${D}å¹´ ${n}å¹´`}catch{return""}}),u=T(()=>{const a=f.value,s=[];for(let D=a-10;D<=a+10;D++)s.push(D);return s}),d=T(()=>{const a=f.value,s=M.value,D=new Date;`${D.getFullYear()}${D.getMonth()}${D.getDate()}`;const n=new Date(a,s,1),Y=new Date(a,s+1,0);let L=n.getDay();L=L===0?7:L;const ee=Y.getDate()+(L-1),W=Math.ceil(ee/7),S=[],U=new Date(a,s,0).getDate();for(let z=L-1;z>0;z--){const F=U-z+1,N=new Date(a,s-1,F);S.push(I(N,!1))}for(let z=1;z<=Y.getDate();z++){const F=new Date(a,s,z);S.push(I(F,!0))}const J=W*7-S.length;for(let z=1;z<=J;z++){const F=new Date(a,s+1,z);S.push(I(F,!1))}return S});function I(a,s,D){const n=new Date,Y=a.getFullYear()===n.getFullYear()&&a.getMonth()===n.getMonth()&&a.getDate()===n.getDate(),L=a.getDay(),ee=L===0||L===6;let W="",S="",U="",J="",z="",F="",N="",te=!1;try{const G=me.fromDate(a).getLunar();W=G.getDayInChinese(),S=G.toFullString(),U=`${G.getYearInGanZhi()}å¹´ ${G.getMonthInGanZhi()}æœˆ ${G.getDayInGanZhi()}æ—¥`;const se=G.getDayYi(),ae=G.getDayJi();se&&se.length>0&&(J=se.join(" ")),ae&&ae.length>0&&(z=ae.join(" "));const fe=G.getJieQi();if(fe&&(F=fe,N=F,te=!0),!N){const le=G.getFestivals();le&&le.length>0&&(N=le[0],te=!0)}N||(N=W)}catch(ve){console.error("è®¡ç®—å†œåŽ†å¤±è´¥:",ve,a)}const ce=H(a).format("YYYY-MM-DD"),je=v.value.get(ce)||[];return{date:a.getDate(),fullDate:H(a).format("YYYYå¹´MMæœˆDDæ—¥"),dateKey:ce,isCurrentMonth:s,isToday:Y,isWeekend:ee,lunar:W,lunarFull:S,ganzhi:U,yi:J,ji:z,jieqi:F,displayText:N,isFestival:te,anniversaries:je}}const X=K({props:{date:{type:Number,required:!0}},setup(a){const s=a.date%3,n=[w,$,c][s];return()=>q(n,{class:"anniversary-icon"})}});function ke(){const a=new Date(p.value);a.setMonth(a.getMonth()-1),p.value=a,h.value=!1,g.value=!1}function _e(){const a=new Date(p.value);a.setMonth(a.getMonth()+1),p.value=a,h.value=!1,g.value=!1}function $e(){p.value=new Date,h.value=!1,g.value=!1}function Me(a){const s=new Date(p.value);s.setFullYear(a),p.value=s,h.value=!1}function De(a){const s=new Date(p.value);s.setMonth(a),p.value=s,g.value=!1}function Ce(a){r.value=a,i.value=!0}function ue(){i.value=!1,setTimeout(()=>{r.value=null},300)}return ne(i,a=>{a?document.body.style.overflow="hidden":document.body.style.overflow=""}),(a,s)=>{const D=Fe;return l(),o("div",Ke,[e("div",Ue,[e("div",Je,[e("div",Xe,[e("div",et,[e("div",tt,[e("button",{class:"text-2xl md:text-3xl font-bold text-red-600 hover:text-red-700 dark:hover:text-red-500 transition-colors cursor-pointer drop-shadow-sm",onClick:s[0]||(s[0]=n=>h.value=!h.value)},k(f.value),1),e("div",st,k(_.value),1)]),e("div",at,[e("button",{class:"text-2xl md:text-3xl font-bold text-yellow-500 hover:text-yellow-600 dark:hover:text-yellow-400 transition-colors cursor-pointer drop-shadow-sm",onClick:s[1]||(s[1]=n=>g.value=!g.value)},k(M.value+1)+"æœˆ ",1)])]),e("div",lt,[e("button",{class:"p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200",onClick:ke,title:"ä¸Šä¸€ä¸ªæœˆ"},[...s[2]||(s[2]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])]),B.value?y("",!0):(l(),oe(D,{key:0,class:"ml-auto px-3 py-1 text-sm bg-amber-600 hover:bg-amber-700 text-white shadow-sm rounded",onClick:$e,title:"å›žåˆ°ä»Šå¤©"},{default:V(()=>[...s[3]||(s[3]=[de(" ä»Šå¤© ",-1)])]),_:1})),e("button",{class:"p-2 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors text-slate-600 dark:text-slate-400 hover:text-slate-900 dark:hover:text-slate-200",onClick:_e,title:"ä¸‹ä¸€ä¸ªæœˆ"},[...s[4]||(s[4]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])]),h.value?(l(),o("div",{key:0,ref_key:"yearPickerRef",ref:R,class:"absolute top-full left-1/2 -translate-x-1/2 w-64 mt-2 bg-white/95 dark:bg-slate-800/95 backdrop-blur-md border border-slate-200 dark:border-slate-700 rounded-lg shadow-lg z-20 p-4 max-h-64 overflow-y-auto"},[e("div",ot,[(l(!0),o(E,null,Z(u.value,n=>(l(),o("button",{key:n,class:P(["px-3 py-2 text-sm rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors text-slate-600 dark:text-slate-400",n===f.value?"bg-amber-600 text-white hover:bg-amber-700":""]),onClick:Y=>Me(n)},k(n),11,rt))),128))])],512)):y("",!0),g.value?(l(),o("div",{key:1,ref_key:"monthPickerRef",ref:m,class:"absolute top-full left-1/2 -translate-x-1/2 w-64 mt-2 bg-white/95 dark:bg-slate-800/95 backdrop-blur-md border border-slate-200 dark:border-slate-700 rounded-lg shadow-lg z-20 p-4 max-h-64 overflow-y-auto"},[e("div",nt,[(l(),o(E,null,Z(t,(n,Y)=>e("button",{key:Y,class:P(["px-3 py-2 text-sm rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors text-slate-600 dark:text-slate-400",Y===M.value?"bg-amber-600 text-white hover:bg-amber-700":""]),onClick:L=>De(Y)},k(n),11,it)),64))])],512)):y("",!0)]),e("div",dt,[e("div",ut,[(l(),o(E,null,Z(j,(n,Y)=>e("div",{key:n,class:P(["text-center text-sm md:text-base font-semibold text-slate-900 dark:text-slate-100 py-2",Y>=5?"bg-red-500 text-white rounded-full w-8 h-8 mx-auto flex items-center justify-center shadow-sm":""])},k(n),3)),64))]),e("div",ct,[(l(!0),o(E,null,Z(d.value,(n,Y)=>(l(),o("div",{key:Y,class:P(["relative min-h-[60px] md:min-h-[80px] p-2 rounded border border-transparent hover:border-amber-600/50 hover:bg-amber-50/50 dark:hover:bg-amber-900/20 transition-all cursor-pointer flex flex-col items-center",{"opacity-40":!n.isCurrentMonth,"bg-amber-50 dark:bg-amber-900/30 border-2 border-amber-600 dark:border-amber-500 shadow-sm":n.isToday,"bg-pink-50/50 dark:bg-pink-900/20":n.anniversaries&&n.anniversaries.length>0,"bg-red-50/20 dark:bg-red-900/20":n.isWeekend}]),onClick:L=>Ce(n)},[e("div",{class:P(["text-sm md:text-base font-semibold text-slate-900 dark:text-slate-100 mb-0.5",{"text-red-600 dark:text-red-400":n.isWeekend,"text-amber-600 dark:text-amber-500 font-bold":n.isToday}])},k(n.date),3),n.displayText?(l(),o("div",{key:0,class:P(["text-xs text-slate-600 dark:text-slate-400 whitespace-nowrap w-full text-center",{"text-red-600 dark:text-red-400 font-medium":n.isFestival}])},k(n.displayText),3)):n.lunar?(l(),o("div",ft,k(n.lunar),1)):y("",!0),n.anniversaries&&n.anniversaries.length>0?(l(),o("div",ht,[A(re(X),{date:n.date,class:"text-pink-400 drop-shadow-sm"},null,8,["date"])])):y("",!0)],10,vt))),128))])])])]),(l(),oe(be,{to:"body"},[A(ze,{name:"fade"},{default:V(()=>[r.value&&i.value?(l(),o("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:Q(ue,["self"])},[e("div",mt,[e("div",{class:"flex items-center justify-between p-4 border-b border-slate-200 dark:border-slate-700"},[s[6]||(s[6]=e("h3",{class:"text-lg font-semibold text-slate-900 dark:text-slate-100"},"é»„åŽ†è¯¦æƒ…",-1)),e("button",{class:"p-1 rounded hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors text-slate-600 dark:text-slate-400",onClick:ue},[...s[5]||(s[5]=[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])])]),r.value?(l(),o("div",xt,[e("div",pt,[s[7]||(s[7]=e("div",{class:"text-sm font-medium text-slate-600 dark:text-slate-400 mb-1"},"å…¬åŽ†",-1)),e("div",yt,k(r.value.fullDate),1)]),r.value.lunarFull?(l(),o("div",gt,[s[8]||(s[8]=e("div",{class:"text-sm font-medium text-slate-600 dark:text-slate-400 mb-1"},"å†œåŽ†",-1)),e("div",bt,k(r.value.lunarFull),1)])):y("",!0),r.value.ganzhi?(l(),o("div",wt,[s[9]||(s[9]=e("div",{class:"text-sm font-medium text-slate-600 dark:text-slate-400 mb-1"},"å¹²æ”¯",-1)),e("div",kt,k(r.value.ganzhi),1)])):y("",!0),r.value.yi||r.value.ji?(l(),o("div",_t,[r.value.yi?(l(),o("div",$t,[s[10]||(s[10]=e("div",{class:"inline-block px-2 py-1 text-xs font-medium bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-400 rounded mr-2"},"å®œ",-1)),e("div",Mt,k(r.value.yi),1)])):y("",!0),r.value.ji?(l(),o("div",Dt,[s[11]||(s[11]=e("div",{class:"inline-block px-2 py-1 text-xs font-medium bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-400 rounded mr-2"},"å¿Œ",-1)),e("div",Ct,k(r.value.ji),1)])):y("",!0)])):y("",!0),r.value.jieqi?(l(),o("div",jt,[s[12]||(s[12]=e("div",{class:"text-sm font-medium text-slate-600 dark:text-slate-400 mb-1"},"èŠ‚æ°”",-1)),e("div",zt,k(r.value.jieqi),1)])):y("",!0),r.value.anniversaries&&r.value.anniversaries.length>0?(l(),o("div",Yt,[s[13]||(s[13]=e("div",{class:"text-sm font-medium text-slate-600 dark:text-slate-400 mb-1"},"çºªå¿µæ—¥",-1)),e("div",Bt,[(l(!0),o(E,null,Z(r.value.anniversaries,n=>(l(),o("div",{key:n.id,class:"px-3 py-2 bg-amber-50 dark:bg-amber-900/30 border border-amber-600/30 dark:border-amber-500/30 rounded text-sm text-slate-900 dark:text-slate-100"},k(n.title),1))),128))])])):y("",!0)])):y("",!0)])])):y("",!0)]),_:1})]))])}}}),Tt=we(It,[["__scopeId","data-v-da5c1ac3"]]),Lt=["viewBox"],At=["cy"],Ft=["d"],Gt=["cy"],St=["cy"],Nt=["cy"],Pt=["cy"],Ot=["cy"],Rt=["cy"],qt=["cy"],Et=["cy"],Zt=["cy"],Ht=["cy"],Qt={class:"animate-pulse",style:{"animation-duration":"3s"}},Vt=["d"],Wt={class:"animate-pulse",style:{"animation-duration":"2.5s"}},Kt=["d"],Ut={class:"animate-pulse",style:{"animation-duration":"3.5s"}},Jt=["d"],Xt={class:"animate-pulse",style:{"animation-duration":"2s"}},es=["cy"],ts={class:"animate-pulse",style:{"animation-duration":"2.3s"}},ss=["cy"],as={class:"animate-pulse",style:{"animation-duration":"1.8s"}},ls=["cy"],os={class:"absolute inset-0 z-10 overflow-hidden pointer-events-none"},rs={key:0,viewBox:"0 0 24 24",class:"w-full h-full drop-shadow-md"},ns={key:1,class:"relative p-2 bg-white dark:bg-slate-800 shadow-xl rounded-xl transform transition-transform hover:scale-105"},is={class:"relative aspect-square overflow-hidden rounded-lg bg-gradient-to-br from-rose-100 to-pink-100 dark:from-slate-700 dark:to-slate-600"},ds=["src"],us=["onClick"],cs={key:0,class:"relative p-1.5 bg-white dark:bg-slate-800 shadow-lg rounded-lg"},vs={class:"relative aspect-square overflow-hidden rounded-md bg-gradient-to-br from-rose-100 to-pink-100 dark:from-slate-700 dark:to-slate-600"},fs=["src"],hs={key:1,viewBox:"0 0 24 24",class:"w-full h-full drop-shadow-sm"},ms=["src"],xs={key:2,class:"absolute bottom-6 left-1/2 -translate-x-1/2 px-4 py-1.5 rounded-full bg-white/10 backdrop-blur-md text-white/90 text-sm font-medium border border-white/5"},ps=K({__name:"MemoryTree",props:{images:{}},setup(O){const w=O,$=C([]),c=C([]),j=C(null),t=C(700);let p=0,f=null,M=null;const h=C(0),g=C(null);function R(){Math.random()>.4&&m("heart"),w.images&&w.images.length>0&&Math.random()>.6&&m("photo")}function m(_){const u=_==="photo",d={id:p++,type:_,src:u?w.images[Math.floor(Math.random()*w.images.length)]:void 0,rotation:(Math.random()-.5)*(u?25:360),scale:u?.85+Math.random()*.25:.6+Math.random()*.5,leftPosition:15+Math.random()*70,animationDuration:u?5+Math.random()*3:7+Math.random()*4,swayAmplitude:u?15+Math.random()*25:40+Math.random()*50};$.value.push(d),setTimeout(()=>{$.value=$.value.filter(X=>X.id!==d.id);const I={...d,rotation:(Math.random()-.5)*70,scale:d.scale*.88};c.value.push(I),c.value.length>25&&c.value.shift()},d.animationDuration*1e3-100)}function r(_){const u=w.images.indexOf(_);u!==-1&&(h.value=u,g.value=_,document.body.style.overflow="hidden")}function i(){g.value=null,document.body.style.overflow=""}function b(){h.value>0&&(h.value--,g.value=w.images[h.value]||null)}function x(){h.value<w.images.length-1&&(h.value++,g.value=w.images[h.value]||null)}function v(_){g.value!==null&&(_.key==="Escape"?i():_.key==="ArrowLeft"?b():_.key==="ArrowRight"&&x())}function B(){if(j.value){const _=j.value.clientHeight;_>0&&(t.value=_)}}return ie(()=>{B(),j.value&&(M=new ResizeObserver(B),M.observe(j.value)),typeof window<"u"&&window.addEventListener("keydown",v),R(),f=Ye(R,1800)}),Be(()=>{f&&clearInterval(f),M&&M.disconnect(),typeof window<"u"&&window.removeEventListener("keydown",v),$.value=[],c.value=[],document.body.style.overflow=""}),(_,u)=>(l(),o("div",{ref_key:"treeContainer",ref:j,class:"relative w-full h-full min-h-[600px] overflow-hidden rounded-2xl bg-gradient-to-b from-rose-50 via-pink-50 to-amber-50 dark:from-slate-900 dark:via-slate-800 dark:to-slate-900 border border-rose-200/30 dark:border-slate-700/50 shadow-xl"},[(l(),o("svg",{class:"absolute bottom-0 left-1/2 -translate-x-1/2 w-full h-full pointer-events-none z-0",viewBox:`0 0 500 ${t.value}`,preserveAspectRatio:"xMidYMax meet"},[u[1]||(u[1]=Ie('<defs data-v-f903f1f2><linearGradient id="trunkGradient" x1="0%" y1="0%" x2="100%" y2="0%" data-v-f903f1f2><stop offset="0%" style="stop-color:#8B4513;stop-opacity:0.9;" data-v-f903f1f2></stop><stop offset="50%" style="stop-color:#A0522D;stop-opacity:0.95;" data-v-f903f1f2></stop><stop offset="100%" style="stop-color:#8B4513;stop-opacity:0.9;" data-v-f903f1f2></stop></linearGradient><linearGradient id="leafGradient" x1="0%" y1="0%" x2="0%" y2="100%" data-v-f903f1f2><stop offset="0%" style="stop-color:#90EE90;stop-opacity:0.95;" data-v-f903f1f2></stop><stop offset="100%" style="stop-color:#228B22;stop-opacity:0.9;" data-v-f903f1f2></stop></linearGradient><filter id="glow" data-v-f903f1f2><feGaussianBlur stdDeviation="3" result="coloredBlur" data-v-f903f1f2></feGaussianBlur><feMerge data-v-f903f1f2><feMergeNode in="coloredBlur" data-v-f903f1f2></feMergeNode><feMergeNode in="SourceGraphic" data-v-f903f1f2></feMergeNode></feMerge></filter><filter id="shadow" data-v-f903f1f2><feDropShadow dx="2" dy="4" stdDeviation="3" flood-opacity="0.2" data-v-f903f1f2></feDropShadow></filter></defs>',1)),e("ellipse",{cx:"250",cy:t.value-20,rx:"180",ry:"25",class:"fill-amber-200/60 dark:fill-amber-900/40"},null,8,At),e("path",{d:`M 235,${t.value-100} Q 233,${t.value*.75} 230,${t.value*.5} L 235,${t.value*.45} Q 237,${t.value*.5} 240,${t.value*.5} Q 242,${t.value*.75} 250,${t.value-100} Z`,fill:"url(#trunkGradient)",filter:"url(#shadow)"},null,8,Ft),e("ellipse",{cx:"180",cy:t.value*.6,rx:"70",ry:"50",class:"fill-emerald-500/90",filter:"url(#shadow)"},null,8,Gt),e("ellipse",{cx:"320",cy:t.value*.6,rx:"70",ry:"50",class:"fill-emerald-500/90",filter:"url(#shadow)"},null,8,St),e("ellipse",{cx:"250",cy:t.value*.55,rx:"80",ry:"55",class:"fill-emerald-400/95",filter:"url(#shadow)"},null,8,Nt),e("ellipse",{cx:"200",cy:t.value*.45,rx:"60",ry:"45",class:"fill-green-500/90",filter:"url(#shadow)"},null,8,Pt),e("ellipse",{cx:"300",cy:t.value*.45,rx:"60",ry:"45",class:"fill-green-500/90",filter:"url(#shadow)"},null,8,Ot),e("ellipse",{cx:"250",cy:t.value*.42,rx:"65",ry:"48",class:"fill-green-400/95",filter:"url(#shadow)"},null,8,Rt),e("ellipse",{cx:"220",cy:t.value*.33,rx:"50",ry:"38",class:"fill-lime-500/90",filter:"url(#shadow)"},null,8,qt),e("ellipse",{cx:"280",cy:t.value*.33,rx:"50",ry:"38",class:"fill-lime-500/90",filter:"url(#shadow)"},null,8,Et),e("ellipse",{cx:"250",cy:t.value*.3,rx:"55",ry:"40",class:"fill-lime-400/95",filter:"url(#shadow)"},null,8,Zt),e("ellipse",{cx:"250",cy:t.value*.22,rx:"35",ry:"28",class:"fill-teal-300/95",filter:"url(#shadow)"},null,8,Ht),e("g",Qt,[e("path",{d:`M 170,${t.value*.52} C 170,${t.value*.51} 173,${t.value*.49} 176,${t.value*.52} C 179,${t.value*.55} 182,${t.value*.52} 182,${t.value*.52} C 182,${t.value*.52} 179,${t.value*.56} 176,${t.value*.58} C 173,${t.value*.56} 170,${t.value*.52} 170,${t.value*.52} Z`,class:"fill-pink-400/80"},null,8,Vt)]),e("g",Wt,[e("path",{d:`M 320,${t.value*.38} C 320,${t.value*.37} 323,${t.value*.35} 326,${t.value*.38} C 329,${t.value*.41} 332,${t.value*.38} 332,${t.value*.38} C 332,${t.value*.38} 329,${t.value*.42} 326,${t.value*.44} C 323,${t.value*.42} 320,${t.value*.38} 320,${t.value*.38} Z`,class:"fill-rose-400/80"},null,8,Kt)]),e("g",Ut,[e("path",{d:`M 245,${t.value*.26} C 245,${t.value*.255} 247,${t.value*.24} 249,${t.value*.26} C 251,${t.value*.28} 253,${t.value*.26} 253,${t.value*.26} C 253,${t.value*.26} 251,${t.value*.29} 249,${t.value*.3} C 247,${t.value*.29} 245,${t.value*.26} 245,${t.value*.26} Z`,class:"fill-red-400/90",filter:"url(#glow)"},null,8,Jt)]),e("g",Xt,[e("circle",{cx:"200",cy:t.value*.5,r:"3",class:"fill-yellow-300/90"},null,8,es)]),e("g",ts,[e("circle",{cx:"290",cy:t.value*.35,r:"3",class:"fill-yellow-300/90"},null,8,ss)]),e("g",as,[e("circle",{cx:"250",cy:t.value*.48,r:"2.5",class:"fill-amber-300/90"},null,8,ls)])],8,Lt)),e("div",os,[A(xe,{tag:"div","enter-active-class":"falling-enter-active","leave-active-class":"falling-leave-active"},{default:V(()=>[(l(!0),o(E,null,Z($.value,d=>(l(),o("div",{key:d.id,class:P(["absolute transform-gpu",d.type==="photo"?"w-20 md:w-28 lg:w-32":"w-8 h-8 md:w-10 md:h-10"]),style:pe({top:"0%",left:`${d.leftPosition}%`,"--sway":`${d.swayAmplitude}px`,transform:`translateX(-50%) rotate(${d.rotation}deg) scale(${d.scale})`,animationDuration:`${d.animationDuration}s`,animationDelay:"0s"})},[d.type==="heart"?(l(),o("svg",rs,[...u[2]||(u[2]=[e("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z",class:"fill-pink-400/80"},null,-1)])])):d.type==="photo"?(l(),o("div",ns,[e("div",is,[e("img",{src:d.src,class:"w-full h-full object-cover",alt:"Memory",draggable:"false"},null,8,ds)]),u[3]||(u[3]=e("div",{class:"absolute -top-1 -right-1 w-3 h-3 border-t-2 border-r-2 border-rose-400 rounded-tr-sm"},null,-1)),u[4]||(u[4]=e("div",{class:"absolute -bottom-1 -left-1 w-3 h-3 border-b-2 border-l-2 border-rose-400 rounded-bl-sm"},null,-1))])):y("",!0)],6))),128))]),_:1}),A(xe,{name:"fade"},{default:V(()=>[(l(!0),o(E,null,Z(c.value,d=>(l(),o("div",{key:"fallen-"+d.id,class:P(["absolute -translate-x-1/2 origin-center transition-all duration-700 opacity-90 hover:opacity-100 hover:scale-110 hover:z-30 cursor-pointer pointer-events-auto",d.type==="photo"?"w-16 md:w-20 z-10":"w-6 h-6 md:w-7 md:h-7 z-0"]),style:pe({bottom:d.type==="photo"?"30px":"35px",left:`${d.leftPosition}%`,transform:`rotate(${d.rotation}deg) scale(${d.scale})`}),onClick:Q(I=>d.type==="photo"&&d.src&&r(d.src),["stop"])},[d.type==="photo"?(l(),o("div",cs,[e("div",vs,[e("img",{src:d.src,class:"w-full h-full object-cover",draggable:"false"},null,8,fs)])])):d.type==="heart"?(l(),o("svg",hs,[...u[5]||(u[5]=[e("path",{d:"M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z",class:"fill-pink-400/70"},null,-1)])])):y("",!0)],14,us))),128))]),_:1})]),(l(),oe(be,{to:"body"},[g.value!==null?(l(),o("div",{key:0,class:"fixed inset-0 z-50 bg-black/95 flex items-center justify-center backdrop-blur-sm",onClick:Q(i,["self"]),onKeydown:Te(i,["esc"]),tabindex:"-1"},[e("button",{class:"absolute top-4 right-4 w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-50 transition-all duration-200 hover:scale-110 active:scale-95 border-none cursor-pointer",onClick:i},[...u[6]||(u[6]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)])]),h.value>0?(l(),o("button",{key:0,class:"absolute left-4 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-50 cursor-pointer transition-all duration-200 hover:scale-110 active:scale-95 border-none",onClick:Q(b,["stop","prevent"]),type:"button"},[...u[7]||(u[7]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1)])])):y("",!0),h.value<O.images.length-1?(l(),o("button",{key:1,class:"absolute right-4 top-1/2 -translate-y-1/2 w-12 h-12 rounded-full bg-white/10 hover:bg-white/20 text-white flex items-center justify-center z-50 cursor-pointer transition-all duration-200 hover:scale-110 active:scale-95 border-none",onClick:Q(x,["stop","prevent"]),type:"button"},[...u[8]||(u[8]=[e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 5l7 7-7 7"})],-1)])])):y("",!0),e("div",{class:"max-w-[90vw] max-h-[90vh] flex items-center justify-center w-full h-full p-4",onClick:u[0]||(u[0]=Q(()=>{},["stop"]))},[g.value!==null?(l(),o("img",{key:0,src:g.value,class:"max-w-full max-h-[85vh] object-contain shadow-2xl rounded-sm select-none",alt:"é¢„è§ˆ"},null,8,ms)):y("",!0)]),O.images.length>1?(l(),o("div",xs,k(h.value+1)+" / "+k(O.images.length),1)):y("",!0)],32)):y("",!0)]))],512))}}),ys=Object.assign(we(ps,[["__scopeId","data-v-f903f1f2"]]),{__name:"MemoryTree"}),gs={class:"min-h-screen bg-gradient-to-br from-surface-100 via-surface-50 to-surface-100"},bs={class:"min-h-screen flex flex-col items-center pt-12 pb-8 px-4 relative"},ws={class:"w-full max-w-4xl z-10 flex flex-col items-center space-y-8"},ks={class:"w-full animate-fade-in shrink-0",style:{"animation-delay":"0.2s"}},_s={class:"flex flex-col items-center space-y-8 w-full animate-slide-up shrink-0",style:{"animation-delay":"0.4s"}},$s={class:"flex gap-6"},Ms={key:0,class:"w-full max-w-md opacity-90 hover:opacity-100 transition-opacity"},Ds={key:0,class:"w-full pt-4 animate-fade-in opacity-90 shrink-0",style:{"animation-delay":"0.6s"}},Cs={},Bs=K({...Cs,__name:"index",setup(O){const w=["/assets/images/couple/couple-1.png","/assets/images/couple/couple-2.png","/assets/images/couple/couple-3.png","/assets/images/couple/couple-4.png"],$=C([...w]),c=Le();async function j(){try{if(c.user){const f=((await ge("/api/daily?take=100")).items||[]).flatMap(M=>Array.isArray(M.mediaUrls)?M.mediaUrls:[]);f.length>0?f.length<5?$.value=[...f,...w]:$.value=f:$.value=[...w]}else $.value=[...w]}catch(p){console.error("åŠ è½½é¦–é¡µç…§ç‰‡å¤±è´¥",p)}}ne(()=>c.user,p=>{p?j():$.value=[...w]},{immediate:!0}),ie(()=>{c.user&&j()});function t(){Ae("/daily")}return(p,f)=>{const M=ye;return l(),o("div",gs,[A(Ge),e("div",bs,[f[2]||(f[2]=e("div",{class:"fixed top-20 left-10 w-64 h-64 bg-primary/8 rounded-full blur-3xl pointer-events-none z-0"},null,-1)),f[3]||(f[3]=e("div",{class:"fixed bottom-20 right-10 w-80 h-80 bg-accent/10 rounded-full blur-3xl pointer-events-none z-0"},null,-1)),e("div",ws,[f[1]||(f[1]=e("div",{class:"bg-white/40 dark:bg-slate-800/40 backdrop-blur-sm px-6 py-2 rounded-full border border-white/50 dark:border-slate-700/50 shadow-sm animate-fade-in shrink-0"},[e("h1",{class:"text-xl md:text-2xl font-serif text-text-secondary tracking-widest text-center opacity-90"}," çˆ±çš„å°äº‹ï¼Œå€¼å¾—è¢«æ¸©æŸ”è®°å½• ")],-1)),e("div",ks,[A(ys,{images:$.value,class:"h-[400px] md:h-[500px] !rounded-xl"},null,8,["images"])]),e("div",_s,[e("div",$s,[e("button",{class:"px-8 py-2.5 rounded-full bg-primary text-primary-foreground font-medium hover:bg-primary/90 hover:scale-105 transition-all shadow-lg active:scale-95 text-sm md:text-base",onClick:t}," å¼€å§‹è®°å½• "),A(M,{to:"/daily",class:"px-8 py-2.5 rounded-full bg-background text-foreground font-medium border border-border hover:bg-accent hover:border-accent-foreground/20 transition-all shadow-sm text-sm md:text-base"},{default:V(()=>[...f[0]||(f[0]=[de(" æŸ¥çœ‹æ—¥å¸¸ ",-1)])]),_:1})]),re(c).user?(l(),o("div",Ms,[A(We,{class:"!bg-transparent !shadow-none !backdrop-blur-none"})])):y("",!0)]),re(c).user?(l(),o("section",Ds,[A(Tt)])):y("",!0)])])])}}});export{Bs as default};
