import{d as k,r as d,a as _,g as a,f as r,h as t,u as s,I as $,e as c,i,b as N,t as g,q as h,_ as D,L as M}from"./DW3SVq1p.js";import{D as q,_ as y,r as B}from"./Cv5foL5a.js";import{D as C,_ as F,a as L,b as R}from"./shU-Sxv5.js";import{_ as U,a as p,b as A}from"./DHqhx6bH.js";import{_ as v}from"./BvfOXczi.js";const E={class:"min-h-screen bg-muted/30"},S={class:"max-w-md mx-auto px-4 py-10"},j={key:0,class:"mb-4 p-3 text-sm text-destructive bg-destructive/10 border border-destructive/20 rounded-md"},H={class:"space-y-2"},I={class:"space-y-2"},T={class:"space-y-2"},z={class:"mt-6 flex items-center justify-between"},W=k({__name:"register",setup(G){const x=$(),u=d(""),f=d(""),o=d(""),m=d(!1),l=d("");async function b(){if(l.value="",!u.value.trim()){l.value="请输入邮箱";return}if(!o.value){l.value="请输入密码";return}if(o.value.length<6){l.value="密码长度至少需要6位";return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u.value.trim())){l.value="邮箱格式不正确";return}m.value=!0;try{await B({email:u.value.trim(),password:o.value,nickName:f.value.trim()||void 0}),await x.push("/user/couple")}catch(e){l.value=e?.friendlyMessage||M(e)}finally{m.value=!1}}return(w,e)=>{const V=D;return c(),_("div",E,[a(q),r("div",S,[a(C,{class:"mb-4"}),a(s(A),null,{default:t(()=>[a(s(F),null,{default:t(()=>[a(s(L),null,{default:t(()=>[...e[3]||(e[3]=[i("注册",-1)])]),_:1}),a(s(R),null,{default:t(()=>[...e[4]||(e[4]=[i("使用邮箱和密码注册，昵称可选（不填写将从邮箱自动生成）",-1)])]),_:1})]),_:1}),a(s(U),null,{default:t(()=>[l.value?(c(),_("div",j,g(l.value),1)):N("",!0),r("form",{class:"space-y-4",onSubmit:h(b,["prevent"])},[r("div",H,[a(s(v),{htmlFor:"email",class:"sr-only"},{default:t(()=>[...e[5]||(e[5]=[i("邮箱",-1)])]),_:1}),a(s(p),{id:"email",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=n=>u.value=n),modelModifiers:{trim:!0},type:"email",placeholder:"邮箱",required:"",autocomplete:"email"},null,8,["modelValue"])]),r("div",I,[a(s(v),{htmlFor:"password",class:"sr-only"},{default:t(()=>[...e[6]||(e[6]=[i("密码",-1)])]),_:1}),a(s(p),{id:"password",modelValue:o.value,"onUpdate:modelValue":e[1]||(e[1]=n=>o.value=n),modelModifiers:{trim:!0},type:"password",placeholder:"密码（至少6位）",required:"",autocomplete:"new-password",minlength:"6"},null,8,["modelValue"])]),r("div",T,[a(s(v),{htmlFor:"nickName",class:"sr-only"},{default:t(()=>[...e[7]||(e[7]=[i("昵称",-1)])]),_:1}),a(s(p),{id:"nickName",modelValue:f.value,"onUpdate:modelValue":e[2]||(e[2]=n=>f.value=n),modelModifiers:{trim:!0},placeholder:"昵称（可选，不填将从邮箱自动生成）",autocomplete:"nickname"},null,8,["modelValue"])]),a(s(y),{type:"submit",class:"w-full",disabled:m.value||!u.value||!o.value||o.value.length<6},{default:t(()=>[i(g(m.value?"注册中…":"注册"),1)]),_:1},8,["disabled"])],32),r("div",z,[e[9]||(e[9]=r("span",{class:"text-sm text-muted-foreground"},"已有账号？",-1)),a(s(y),{variant:"link",class:"p-0 h-auto","as-child":""},{default:t(()=>[a(V,{to:"/user/login"},{default:t(()=>[...e[8]||(e[8]=[i("去登录",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})])])}}});export{W as default};
