import{aJ as me,aK as ve,d as g,m as f,h as s,p as E,u as e,e as u,N as _,aL as ne,aM as re,aN as he,aO as be,c as N,g as o,a as w,f as d,T as ie,aP as ye,r as A,l as _e,w as H,t as P,W as xe,b as T,F as R,n as we,P as ke,au as Ce,D as Q,aQ as $e,K as V,x as Se,k as B,E as j,M as le,a2 as W,al as de,am as ue,U as x,aR as Be,O as D,aS as De,aT as Pe,a6 as X,aU as ze,aV as Me,aW as Oe,aX as Ae,aB as je,aE as ce,aC as Te,aG as Ue,aD as Ne,aF as Fe,aY as Le,aH as Ie,aZ as Re,a_ as Ve,a$ as He,b0 as Ee,b1 as We,b2 as Ke,o as qe,y as Ge,z as Je,J as Xe,_ as Ye,i as p,b3 as Qe,G as Ze}from"./DW3SVq1p.js";function C(...a){return me(ve(a))}const $=g({__name:"Button",props:{variant:{},size:{},class:{},asChild:{type:Boolean},as:{default:"button"}},setup(a){const t=a;return(r,i)=>(u(),f(e(ne),{"data-slot":"button",as:a.as,"as-child":a.asChild,class:E(e(C)(e(et)({variant:a.variant,size:a.size}),t.class))},{default:s(()=>[_(r.$slots,"default")]),_:3},8,["as","as-child","class"]))}}),et=re("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}}),tt={key:"moon",class:"w-5 h-5 text-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},at={key:"sun",class:"w-5 h-5 text-foreground",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24","aria-hidden":"true"},st=g({__name:"DarkToggle",setup(a){const t=he();be({meta:[{id:"theme-color",name:"theme-color",content:()=>t.value==="dark"?"#0f172a":"#ffffff"}]});function r(){t.preference=t.value==="dark"?"light":"dark"}const i=N(()=>t.value==="dark");return(l,m)=>{const b=$;return u(),f(b,{variant:"ghost",size:"icon",class:"relative w-8 h-8 hover:bg-muted/50",onClick:r,"aria-label":e(i)?"åˆ‡æ¢åˆ°äº®è‰²æ¨¡å¼":"åˆ‡æ¢åˆ°æš—é»‘æ¨¡å¼"},{default:s(()=>[o(ie,{"enter-active-class":"transition-all duration-300 ease-out","enter-from-class":"rotate-90 scale-0 opacity-0","enter-to-class":"rotate-0 scale-100 opacity-100","leave-active-class":"transition-all duration-200 ease-in","leave-from-class":"rotate-0 scale-100 opacity-100","leave-to-class":"-rotate-90 scale-0 opacity-0",mode:"out-in"},{default:s(()=>[e(i)?(u(),w("svg",tt,[...m[0]||(m[0]=[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"},null,-1)])])):(u(),w("svg",at,[...m[1]||(m[1]=[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"},null,-1)])]))]),_:1})]),_:1},8,["aria-label"])}}}),ot=Object.assign(st,{__name:"DarkToggle"}),nt=ye("/assets/images/couple/couple-1.png"),rt={class:"text-secondary-foreground"},it={key:0,class:"absolute right-0 top-full mt-2 w-64 rounded-lg border bg-popover shadow-lg z-50 overflow-hidden"},lt={key:0,class:"p-2"},dt={class:"grid grid-cols-2 gap-1"},ut=["onClick"],ct={class:"text-2xl"},pt={class:"text-sm text-foreground"},ft={key:1,class:"p-3"},gt=g({__name:"UserStatusSelector",props:{currentStatus:{}},emits:["update"],setup(a,{emit:t}){const r=t,i=A(!1),l=A(!1),m=A(""),b=A(null),y=A(null);_e(y,()=>{i.value=!1});const F=$e("closeOtherPopups",()=>{});H(i,S=>{S&&F()}),H(l,async S=>{S&&(await V(),b.value?.focus())});const K=[{key:"happy",label:"å¼€å¿ƒ",emoji:"ğŸ˜Š"},{key:"busy",label:"å¿™ç¢Œ",emoji:"ğŸ’¼"},{key:"thinking",label:"åœ¨æ€è€ƒ",emoji:"ğŸ¤”"},{key:"working",label:"å·¥ä½œä¸­",emoji:"ğŸ’»"},{key:"relaxing",label:"ä¼‘æ¯ä¸­",emoji:"ğŸ˜Œ"},{key:"eating",label:"åƒé¥­ä¸­",emoji:"ğŸ½ï¸"},{key:"sporting",label:"åœ¨è¿åŠ¨",emoji:"ğŸƒ"},{key:"traveling",label:"æ—…è¡Œä¸­",emoji:"âœˆï¸"},{key:"sleeping",label:"ç¡è§‰ä¸­",emoji:"ğŸ˜´"},{key:"studying",label:"å­¦ä¹ ä¸­",emoji:"ğŸ“š"},{key:"shopping",label:"è´­ç‰©ä¸­",emoji:"ğŸ›ï¸"},{key:"loving",label:"æ‹çˆ±ä¸­",emoji:"ğŸ’•"}];function q(S){r("update",S.label),i.value=!1,l.value=!1}function G(){r("update",null),i.value=!1,l.value=!1}function M(){const S=m.value.trim();S&&(r("update",S),i.value=!1,l.value=!1,m.value="")}function L(){l.value=!1,m.value=""}return(S,h)=>(u(),w("div",{class:"relative",ref_key:"containerRef",ref:y},[a.currentStatus?(u(),w("button",{key:0,class:"flex items-center gap-1 py-1 px-2 rounded-full bg-secondary hover:bg-secondary/80 transition-colors text-sm",onClick:h[0]||(h[0]=k=>i.value=!i.value)},[d("span",rt,P(a.currentStatus),1),o(e(xe),{class:"w-4 h-4 text-secondary-foreground/70"})])):(u(),w("button",{key:1,class:"flex items-center gap-1.5 px-2.5 py-1 rounded-full bg-secondary hover:bg-secondary/80 transition-colors text-sm text-secondary-foreground",onClick:h[1]||(h[1]=k=>i.value=!i.value)},[...h[4]||(h[4]=[d("span",null,"è®¾ç½®çŠ¶æ€",-1)])])),o(ie,{name:"fade"},{default:s(()=>[i.value?(u(),w("div",it,[l.value?(u(),w("div",ft,[h[7]||(h[7]=d("div",{class:"text-xs text-muted-foreground mb-2"},"è¾“å…¥è‡ªå®šä¹‰çŠ¶æ€",-1)),ke(d("input",{ref_key:"customInputRef",ref:b,"onUpdate:modelValue":h[3]||(h[3]=k=>m.value=k),type:"text",placeholder:"è¾“å…¥ä½ çš„çŠ¶æ€...",maxlength:"20",class:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 transition-colors",onKeyup:[Q(M,["enter"]),Q(L,["esc"])]},null,544),[[Ce,m.value]]),d("div",{class:"flex gap-2 mt-3"},[d("button",{class:"flex-1 px-3 py-2 text-sm bg-muted hover:bg-muted/80 rounded-lg transition-colors",onClick:L}," å–æ¶ˆ "),d("button",{class:"flex-1 px-3 py-2 text-sm bg-primary text-primary-foreground hover:bg-primary/90 rounded-lg transition-colors",onClick:M}," ç¡®å®š ")])])):(u(),w("div",lt,[h[6]||(h[6]=d("div",{class:"text-xs text-muted-foreground px-2 py-1 mb-1"},"é€‰æ‹©ä¸€ä¸ªçŠ¶æ€",-1)),d("div",dt,[(u(),w(R,null,we(K,k=>d("button",{key:k.key,class:E(["flex flex-col items-center gap-1 p-3 rounded-lg hover:bg-accent transition-colors",{"bg-accent":a.currentStatus===k.label}]),onClick:Y=>q(k)},[d("span",ct,P(k.emoji),1),d("span",pt,P(k.label),1)],10,ut)),64))]),d("button",{class:"w-full mt-2 px-3 py-2 text-sm text-muted-foreground hover:bg-accent hover:text-accent-foreground rounded-lg transition-colors border",onClick:h[2]||(h[2]=k=>l.value=!0)},[...h[5]||(h[5]=[d("span",{class:"flex items-center justify-center gap-1"},[d("span",null,"âœï¸"),d("span",null,"è‡ªå®šä¹‰çŠ¶æ€")],-1)])]),a.currentStatus?(u(),w("button",{key:0,class:"w-full mt-2 px-3 py-2 text-sm text-muted-foreground hover:bg-destructive/10 hover:text-destructive rounded-lg transition-colors",onClick:G}," æ¸…é™¤çŠ¶æ€ ")):T("",!0)]))])):T("",!0)]),_:1})],512))}}),Z=Object.assign(Se(gt,[["__scopeId","data-v-31530a85"]]),{__name:"UserStatusSelector"});async function qt(a){const t=await B("/api/auth/login",{method:"POST",body:a});return j().setUser(t.user),t}async function Gt(a){const t=await B("/api/auth/register",{method:"POST",body:a});return j().setUser(t.user),t}async function mt(){await B("/api/auth/logout",{method:"POST"}),j().clearUser()}async function vt(a){const t=await B("/api/auth/status",{method:"PATCH",body:{status:a}});return j().updateUser({status:t.status,statusUpdatedAt:t.statusUpdatedAt}),t}async function Jt(a){const t=await B("/api/auth/nickname",{method:"PATCH",body:{nickName:a}});return j().updateUser({nickName:t.nickName}),t}async function Xt(a){const t=new FormData;t.append("file",a);const r=await B("/api/auth/avatar",{method:"POST",body:t});return j().updateUser({avatarUrl:r.avatarUrl}),r}function Yt(a){const t=a?.take,r=a?.unreadOnly||!1,i=`/api/notifications?take=${t}&unreadOnly=${r}`;return le(i)}function ht(){return le("/api/notifications/unread-count",{server:!1,onResponseError({response:a}){a.status}})}async function Qt(a){return B(`/api/notifications/${a}/read`,{method:"PATCH"})}async function Zt(){return B("/api/notifications/read-all",{method:"PATCH"})}const bt=g({__name:"DropdownMenu",props:{defaultOpen:{type:Boolean},open:{type:Boolean},dir:{},modal:{type:Boolean}},emits:["update:open"],setup(a,{emit:t}){const l=W(a,t);return(m,b)=>(u(),f(e(Be),x({"data-slot":"dropdown-menu"},e(l)),{default:s(y=>[_(m.$slots,"default",de(ue(y)))]),_:3},16))}}),yt=g({inheritAttrs:!1,__name:"DropdownMenuContent",props:{forceMount:{type:Boolean},loop:{type:Boolean},side:{},sideOffset:{default:4},sideFlip:{type:Boolean},align:{},alignOffset:{},alignFlip:{type:Boolean},avoidCollisions:{type:Boolean},collisionBoundary:{},collisionPadding:{},arrowPadding:{},sticky:{},hideWhenDetached:{type:Boolean},positionStrategy:{},updatePositionStrategy:{},disableUpdateOnLayoutShift:{type:Boolean},prioritizePosition:{type:Boolean},reference:{},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","closeAutoFocus"],setup(a,{emit:t}){const r=a,i=t,l=D(r,"class"),m=W(l,i);return(b,y)=>(u(),f(e(Pe),null,{default:s(()=>[o(e(De),x({"data-slot":"dropdown-menu-content"},{...b.$attrs,...e(m)},{class:e(C)("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--reka-dropdown-menu-content-available-height) min-w-[8rem] origin-(--reka-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",r.class)}),{default:s(()=>[_(b.$slots,"default")]),_:3},16,["class"])]),_:3}))}}),U=g({__name:"DropdownMenuItem",props:{disabled:{type:Boolean},textValue:{},asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean},variant:{default:"default"}},setup(a){const t=a,r=D(t,"inset","variant","class"),i=X(r);return(l,m)=>(u(),f(e(ze),x({"data-slot":"dropdown-menu-item","data-inset":a.inset?"":void 0,"data-variant":a.variant},e(i),{class:e(C)("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",t.class)}),{default:s(()=>[_(l.$slots,"default")]),_:3},16,["data-inset","data-variant","class"]))}}),_t=g({__name:"DropdownMenuLabel",props:{asChild:{type:Boolean},as:{},class:{},inset:{type:Boolean}},setup(a){const t=a,r=D(t,"class","inset"),i=X(r);return(l,m)=>(u(),f(e(Me),x({"data-slot":"dropdown-menu-label","data-inset":a.inset?"":void 0},e(i),{class:e(C)("px-2 py-1.5 text-sm font-medium data-[inset]:pl-8",t.class)}),{default:s(()=>[_(l.$slots,"default")]),_:3},16,["data-inset","class"]))}}),ee=g({__name:"DropdownMenuSeparator",props:{asChild:{type:Boolean},as:{},class:{}},setup(a){const t=a,r=D(t,"class");return(i,l)=>(u(),f(e(Oe),x({"data-slot":"dropdown-menu-separator"},e(r),{class:e(C)("bg-border -mx-1 my-1 h-px",t.class)}),null,16,["class"]))}}),xt=g({__name:"DropdownMenuTrigger",props:{disabled:{type:Boolean},asChild:{type:Boolean},as:{}},setup(a){const r=X(a);return(i,l)=>(u(),f(e(Ae),x({"data-slot":"dropdown-menu-trigger"},e(r)),{default:s(()=>[_(i.$slots,"default")]),_:3},16))}}),wt=g({__name:"Sheet",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(a,{emit:t}){const l=W(a,t);return(m,b)=>(u(),f(e(je),x({"data-slot":"sheet"},e(l)),{default:s(y=>[_(m.$slots,"default",de(ue(y)))]),_:3},16))}}),O=g({__name:"SheetClose",props:{asChild:{type:Boolean},as:{}},setup(a){const t=a;return(r,i)=>(u(),f(e(ce),x({"data-slot":"sheet-close"},t),{default:s(()=>[_(r.$slots,"default")]),_:3},16))}}),kt=g({__name:"SheetOverlay",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(a){const t=a,r=D(t,"class");return(i,l)=>(u(),f(e(Te),x({"data-slot":"sheet-overlay",class:e(C)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",t.class)},e(r)),{default:s(()=>[_(i.$slots,"default")]),_:3},16,["class"]))}}),Ct=g({inheritAttrs:!1,__name:"SheetContent",props:{class:{},side:{default:"right"},forceMount:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(a,{emit:t}){const r=a,i=t,l=D(r,"class","side"),m=W(l,i);return(b,y)=>(u(),f(e(Ue),null,{default:s(()=>[o(kt),o(e(Ne),x({"data-slot":"sheet-content",class:e(C)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out fixed z-50 flex flex-col gap-4 shadow-lg transition ease-in-out data-[state=closed]:duration-300 data-[state=open]:duration-500",a.side==="right"&&"data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right inset-y-0 right-0 h-full w-3/4 border-l sm:max-w-sm",a.side==="left"&&"data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left inset-y-0 left-0 h-full w-3/4 border-r sm:max-w-sm",a.side==="top"&&"data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top inset-x-0 top-0 h-auto border-b",a.side==="bottom"&&"data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom inset-x-0 bottom-0 h-auto border-t",r.class)},{...b.$attrs,...e(m)}),{default:s(()=>[_(b.$slots,"default"),o(e(ce),{class:"ring-offset-background focus:ring-ring data-[state=open]:bg-secondary absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none"},{default:s(()=>[o(e(Fe),{class:"size-4"}),y[0]||(y[0]=d("span",{class:"sr-only"},"Close",-1))]),_:1})]),_:3},16,["class"])]),_:3}))}}),$t=g({__name:"SheetDescription",props:{asChild:{type:Boolean},as:{},class:{}},setup(a){const t=a,r=D(t,"class");return(i,l)=>(u(),f(e(Le),x({"data-slot":"sheet-description",class:e(C)("text-muted-foreground text-sm",t.class)},e(r)),{default:s(()=>[_(i.$slots,"default")]),_:3},16,["class"]))}}),St=g({__name:"SheetHeader",props:{class:{}},setup(a){const t=a;return(r,i)=>(u(),w("div",{"data-slot":"sheet-header",class:E(e(C)("flex flex-col gap-1.5 p-4",t.class))},[_(r.$slots,"default")],2))}}),Bt=g({__name:"SheetTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(a){const t=a,r=D(t,"class");return(i,l)=>(u(),f(e(Ie),x({"data-slot":"sheet-title",class:e(C)("text-foreground font-semibold",t.class)},e(r)),{default:s(()=>[_(i.$slots,"default")]),_:3},16,["class"]))}}),Dt=g({__name:"SheetTrigger",props:{asChild:{type:Boolean},as:{}},setup(a){const t=a;return(r,i)=>(u(),f(e(Re),x({"data-slot":"sheet-trigger"},t),{default:s(()=>[_(r.$slots,"default")]),_:3},16))}}),te=g({__name:"Avatar",props:{class:{}},setup(a){const t=a;return(r,i)=>(u(),f(e(Ve),{"data-slot":"avatar",class:E(e(C)("relative flex size-8 shrink-0 overflow-hidden rounded-full",t.class))},{default:s(()=>[_(r.$slots,"default")]),_:3},8,["class"]))}}),ae=g({__name:"AvatarFallback",props:{delayMs:{},asChild:{type:Boolean},as:{},class:{}},setup(a){const t=a,r=D(t,"class");return(i,l)=>(u(),f(e(He),x({"data-slot":"avatar-fallback"},e(r),{class:e(C)("bg-muted flex size-full items-center justify-center rounded-full",t.class)}),{default:s(()=>[_(i.$slots,"default")]),_:3},16,["class"]))}}),se=g({__name:"AvatarImage",props:{src:{},referrerPolicy:{},crossOrigin:{},asChild:{type:Boolean},as:{}},setup(a){const t=a;return(r,i)=>(u(),f(e(Ee),x({"data-slot":"avatar-image"},t,{class:"aspect-square size-full"}),{default:s(()=>[_(r.$slots,"default")]),_:3},16))}}),Pt=g({__name:"Badge",props:{asChild:{type:Boolean},as:{},variant:{},class:{}},setup(a){const t=a,r=D(t,"class");return(i,l)=>(u(),f(e(ne),x({"data-slot":"badge",class:e(C)(e(zt)({variant:a.variant}),t.class)},e(r)),{default:s(()=>[_(i.$slots,"default")]),_:3},16,["class"]))}}),zt=re("inline-flex items-center justify-center rounded-full border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}}),oe=g({__name:"Separator",props:{orientation:{default:"horizontal"},decorative:{type:Boolean,default:!0},asChild:{type:Boolean},as:{},class:{}},setup(a){const t=a,r=D(t,"class");return(i,l)=>(u(),f(e(We),x({"data-slot":"separator"},e(r),{class:e(C)("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",t.class)}),null,16,["class"]))}}),Mt={class:"fixed top-0 left-0 right-0 z-30 w-screen flex items-center justify-between px-4 md:px-8 lg:px-12 py-3 bg-background/95 backdrop-blur-md border-b border-border pt-[calc(0.75rem+env(safe-area-inset-top))]"},Ot={class:"hidden md:flex items-center gap-6 lg:gap-8 text-sm",role:"navigation","aria-label":"ä¸»å¯¼èˆª"},At={class:"flex items-center gap-1.5 md:gap-2 relative flex-shrink-0"},jt={class:"text-xl"},Tt={class:"md:block hidden"},Ut={class:"hidden md:inline text-sm font-normal"},Nt={class:"flex items-center justify-between w-full"},Ft={key:0,class:"text-xs text-muted-foreground","aria-hidden":"true"},Lt={class:"flex flex-col gap-4 mt-6"},It={class:"flex items-center gap-3"},Rt={class:"flex flex-col"},Vt={class:"font-medium"},Ht={class:"flex items-center justify-between px-2 py-2"},Et={class:"flex flex-col gap-2",role:"navigation","aria-label":"ç§»åŠ¨ç«¯å¯¼èˆª"},Wt=g({__name:"DogHeader",setup(a){const t=A(!1),r=A(!1),i=j(),l=N(()=>i.user),{data:m,refresh:b}=ht(),y=N(()=>m.value?.count||0),{isNewYear:F,toggleDecoration:K}=Ke(),q=N(()=>F.value?"ğŸ´":"âœ¨"),G=N(()=>F.value?"é©¬å¹´è£…é¥°å·²å¼€å¯,ç‚¹å‡»åˆ‡æ¢":"å¼€å¯èŠ‚æ—¥è£…é¥°");H(y,c=>{"setAppBadge"in navigator&&(c>0?navigator.setAppBadge(c).catch(n=>{console.warn("è®¾ç½® PWA è§’æ ‡å¤±è´¥:",n)}):navigator.clearAppBadge().catch(n=>{console.warn("æ¸…é™¤ PWA è§’æ ‡å¤±è´¥:",n)}))},{immediate:!0});let M=null;qe(async()=>{i.initialized||await i.fetchUser(),await V(),await b(),k(),M=Ge(()=>{b()},3e4),window.addEventListener("user-login-success",async()=>{await V(),setTimeout(async()=>{await b(),k()},200)}),typeof document<"u"&&document.addEventListener("visibilitychange",async()=>{document.hidden||(await b(),k())})}),Je(()=>{M&&(clearInterval(M),M=null)});const L=Xe();H(()=>L.fullPath,async(c,n)=>{c!==n&&n==="/notifications"&&(await V(),await b())},{immediate:!1});async function S(){try{await mt(),Ze("/user/login")}catch(c){console.error("é€€å‡ºç™»å½•å¤±è´¥:",c)}}async function h(c){try{await vt(c)}catch(n){console.error("æ›´æ–°çŠ¶æ€å¤±è´¥:",n)}}async function k(){if(!(!("serviceWorker"in navigator)||!("PushManager"in window)))try{const n=await(await navigator.serviceWorker.ready).pushManager.getSubscription();t.value=!!n}catch(c){console.error("æ£€æŸ¥æ¨é€çŠ¶æ€å¤±è´¥:",c)}}function Y(c){const n="=".repeat((4-c.length%4)%4),v=(c+n).replace(/-/g,"+").replace(/_/g,"/"),z=window.atob(v),J=new Uint8Array(z.length);for(let I=0;I<z.length;++I)J[I]=z.charCodeAt(I);return J}async function pe(){if(!("Notification"in window)){alert("æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒé€šçŸ¥åŠŸèƒ½");return}r.value=!0;try{if(await Notification.requestPermission()==="granted"){const{key:n}=await B("/api/notifications/vapid-public-key");if(!n)throw new Error("æ— æ³•è·å– VAPID å…¬é’¥");const z=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Y(n)});await B("/api/notifications/subscribe",{method:"POST",body:{subscription:z}}),t.value=!0,alert("é€šçŸ¥å·²å¼€å¯ï¼")}else alert("æ‚¨æ‹’ç»äº†é€šçŸ¥æƒé™ï¼Œæ— æ³•æ¥æ”¶æ¶ˆæ¯æé†’")}catch(c){console.error("è¯·æ±‚é€šçŸ¥æƒé™å¤±è´¥:",c),alert("å¼€å¯é€šçŸ¥å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{r.value=!1}}async function fe(){r.value=!0;try{const n=await(await navigator.serviceWorker.ready).pushManager.getSubscription();if(n){try{await B("/api/notifications/unsubscribe",{method:"POST",body:{endpoint:n.endpoint}})}catch(v){console.warn("åç«¯åˆ é™¤è®¢é˜…å¤±è´¥ï¼Œç»§ç»­å–æ¶ˆæµè§ˆå™¨è®¢é˜…",v)}await n.unsubscribe()}t.value=!1,alert("é€šçŸ¥å·²å…³é—­")}catch(c){console.error("å…³é—­é€šçŸ¥å¤±è´¥:",c),alert("å…³é—­é€šçŸ¥å¤±è´¥ï¼Œè¯·é‡è¯•")}finally{r.value=!1}}async function ge(){if("Notification"in window)if(Notification.permission==="granted")try{await B("/api/test-push",{method:"POST"}),alert("æµ‹è¯•é€šçŸ¥å·²å‘é€ï¼Œè¯·æ£€æŸ¥é€šçŸ¥æ ")}catch(c){console.error("å‘é€æµ‹è¯•é€šçŸ¥å¤±è´¥:",c),alert("å‘é€å¤±è´¥")}else alert('è¯·å…ˆç‚¹å‡»"å¼€å¯é€šçŸ¥"')}return(c,n)=>{const v=Ye,z=ot;return u(),w(R,null,[d("header",Mt,[o(v,{to:"/",class:"flex items-center gap-2 md:gap-3 cursor-pointer hover:opacity-80 transition flex-shrink-0 min-w-0","aria-label":"å›åˆ°é¦–é¡µ"},{default:s(()=>[...n[1]||(n[1]=[d("img",{src:nt,alt:"My Doggy Love Logo",class:"w-6 h-6 flex-shrink-0"},null,-1),d("span",{class:"font-semibold text-sm md:text-base truncate"},"My Doggy Love",-1)])]),_:1}),d("nav",Ot,[o(e($),{variant:"link","as-child":"",class:"text-foreground hover:no-underline px-0"},{default:s(()=>[o(v,{to:"/"},{default:s(()=>[...n[2]||(n[2]=[p("é¦–é¡µ",-1)])]),_:1})]),_:1}),o(e($),{variant:"link","as-child":"",class:"text-foreground hover:no-underline px-0"},{default:s(()=>[o(v,{to:"/daily"},{default:s(()=>[...n[3]||(n[3]=[p("æ—¥å¸¸",-1)])]),_:1})]),_:1}),o(e($),{variant:"link","as-child":"",class:"text-foreground hover:no-underline px-0"},{default:s(()=>[o(v,{to:"/anniversaries"},{default:s(()=>[...n[4]||(n[4]=[p("çºªå¿µæ—¥",-1)])]),_:1})]),_:1}),o(e($),{variant:"link","as-child":"",class:"text-foreground hover:no-underline px-0"},{default:s(()=>[o(v,{to:"/wishes"},{default:s(()=>[...n[5]||(n[5]=[p("æ„¿æœ›æ¸…å•",-1)])]),_:1})]),_:1}),o(e($),{variant:"link","as-child":"",class:"text-foreground hover:no-underline px-0"},{default:s(()=>[o(v,{to:"/messages"},{default:s(()=>[...n[6]||(n[6]=[p("ç•™è¨€æ¿",-1)])]),_:1})]),_:1})]),d("div",At,[o(z),o(e($),{variant:"ghost",size:"icon",class:"relative w-8 h-8 hover:bg-muted/50",onClick:e(K),"aria-label":G.value,title:"åˆ‡æ¢èŠ‚æ—¥è£…é¥°"},{default:s(()=>[d("span",jt,P(q.value),1)]),_:1},8,["onClick","aria-label"]),l.value?(u(),w(R,{key:0},[d("div",Tt,[o(Z,{"current-status":l.value?.status,onUpdate:h},null,8,["current-status"])]),o(e($),{variant:"ghost",size:"icon","as-child":"",class:"relative w-8 h-8 hover:bg-muted/50 group","aria-label":y.value>0?`æœ‰ ${y.value} æ¡æœªè¯»é€šçŸ¥`:"æŸ¥çœ‹é€šçŸ¥"},{default:s(()=>[o(v,{to:"/notifications"},{default:s(()=>[o(e(Qe),{class:"w-6 h-6 text-muted-foreground hover:text-foreground transition-colors","aria-hidden":"true"}),y.value>0?(u(),f(e(Pt),{key:0,variant:"destructive","aria-label":`${y.value} æ¡æœªè¯»é€šçŸ¥`,class:"absolute -top-1 -right-1 px-1.5 py-0.5 h-5 min-w-[18px] flex items-center justify-center text-[10px] font-semibold shadow-md border-2 border-white dark:border-slate-900 bg-red-600 dark:bg-red-600 text-white animate-in zoom-in-50 duration-200 group-hover:scale-110 transition-transform"},{default:s(()=>[p(P(y.value>99?"99+":y.value),1)]),_:1},8,["aria-label"])):T("",!0)]),_:1})]),_:1},8,["aria-label"]),o(e(bt),null,{default:s(()=>[o(e(xt),{"as-child":""},{default:s(()=>[o(e($),{variant:"ghost",class:"flex items-center gap-2 px-1 hover:bg-transparent","aria-label":"ç”¨æˆ·èœå•"},{default:s(()=>[o(e(te),{class:"w-8 h-8"},{default:s(()=>[o(e(se),{src:l.value.avatarUrl||"/assets/images/xiaobai/xiaobai-2.png"},null,8,["src"]),o(e(ae),null,{default:s(()=>[p(P(l.value.nickName?.slice(0,2)||"ç”¨æˆ·"),1)]),_:1})]),_:1}),d("span",Ut,P(l.value.nickName),1)]),_:1})]),_:1}),o(e(yt),{align:"end",class:"w-48"},{default:s(()=>[o(e(_t),null,{default:s(()=>[...n[7]||(n[7]=[p("æˆ‘çš„è´¦æˆ·",-1)])]),_:1}),o(e(ee)),o(e(U),{"as-child":""},{default:s(()=>[o(v,{to:"/user/profile",class:"w-full cursor-pointer"},{default:s(()=>[...n[8]||(n[8]=[p("ç”¨æˆ·èµ„æ–™",-1)])]),_:1})]),_:1}),o(e(U),{"as-child":""},{default:s(()=>[o(v,{to:"/user/couple",class:"w-full cursor-pointer"},{default:s(()=>[...n[9]||(n[9]=[p("æƒ…ä¾£ç»‘å®š",-1)])]),_:1})]),_:1}),o(e(U),{onClick:n[0]||(n[0]=J=>t.value?fe():pe()),disabled:r.value,"aria-label":t.value?"å…³é—­æ¨é€é€šçŸ¥":"å¼€å¯æ¨é€é€šçŸ¥"},{default:s(()=>[d("div",Nt,[d("span",null,P(t.value?"å…³é—­é€šçŸ¥":"å¼€å¯é€šçŸ¥"),1),r.value?(u(),w("span",Ft,"...")):T("",!0)])]),_:1},8,["disabled","aria-label"]),t.value?(u(),f(e(U),{key:0,onClick:ge},{default:s(()=>[...n[10]||(n[10]=[p(" æµ‹è¯•é€šçŸ¥ ",-1)])]),_:1})):T("",!0),o(e(ee)),o(e(U),{onClick:S,class:"text-destructive focus:text-destructive"},{default:s(()=>[...n[11]||(n[11]=[p(" é€€å‡ºç™»å½• ",-1)])]),_:1})]),_:1})]),_:1})],64)):(u(),w(R,{key:1},[o(e($),{variant:"ghost","as-child":""},{default:s(()=>[o(v,{to:"/user/login"},{default:s(()=>[...n[12]||(n[12]=[p("ç™»å½•",-1)])]),_:1})]),_:1}),o(e($),{"as-child":""},{default:s(()=>[o(v,{to:"/user/register"},{default:s(()=>[...n[13]||(n[13]=[p("æ³¨å†Œ",-1)])]),_:1})]),_:1})],64)),l.value?(u(),f(e(wt),{key:2},{default:s(()=>[o(e(Dt),{"as-child":""},{default:s(()=>[o(e($),{variant:"ghost",size:"icon",class:"md:hidden","aria-label":"æ‰“å¼€èœå•"},{default:s(()=>[...n[14]||(n[14]=[d("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[d("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16m-7 6h7"})],-1)])]),_:1})]),_:1}),o(e(Ct),{side:"right",class:"w-[250px] sm:w-[300px]"},{default:s(()=>[o(e(St),null,{default:s(()=>[o(e(Bt),null,{default:s(()=>[...n[15]||(n[15]=[p("å¯¼èˆª",-1)])]),_:1}),o(e($t))]),_:1}),d("div",Lt,[d("div",It,[o(e(te),{class:"w-10 h-10"},{default:s(()=>[o(e(se),{src:l.value?.avatarUrl||"/assets/images/xiaobai/xiaobai-2.png"},null,8,["src"]),o(e(ae),null,{default:s(()=>[p(P(l.value?.nickName?.slice(0,2)||"ç”¨æˆ·"),1)]),_:1})]),_:1}),d("div",Rt,[d("span",Vt,P(l.value?.nickName),1),o(Z,{"current-status":l.value?.status,onUpdate:h,size:"sm"},null,8,["current-status"])])]),d("div",Ht,[n[16]||(n[16]=d("span",{class:"text-sm"},"å¤–è§‚æ¨¡å¼",-1)),o(z)]),o(e(oe)),d("nav",Et,[o(e(O),{"as-child":""},{default:s(()=>[o(v,{to:"/",class:"px-2 py-2 hover:bg-muted rounded-md transition-colors"},{default:s(()=>[...n[17]||(n[17]=[p("é¦–é¡µ",-1)])]),_:1})]),_:1}),o(e(O),{"as-child":""},{default:s(()=>[o(v,{to:"/daily",class:"px-2 py-2 hover:bg-muted rounded-md transition-colors"},{default:s(()=>[...n[18]||(n[18]=[p("æ—¥å¸¸",-1)])]),_:1})]),_:1}),o(e(O),{"as-child":""},{default:s(()=>[o(v,{to:"/anniversaries",class:"px-2 py-2 hover:bg-muted rounded-md transition-colors"},{default:s(()=>[...n[19]||(n[19]=[p("çºªå¿µæ—¥",-1)])]),_:1})]),_:1}),o(e(O),{"as-child":""},{default:s(()=>[o(v,{to:"/wishes",class:"px-2 py-2 hover:bg-muted rounded-md transition-colors"},{default:s(()=>[...n[20]||(n[20]=[p("æ„¿æœ›æ¸…å•",-1)])]),_:1})]),_:1}),o(e(O),{"as-child":""},{default:s(()=>[o(v,{to:"/messages",class:"px-2 py-2 hover:bg-muted rounded-md transition-colors"},{default:s(()=>[...n[21]||(n[21]=[p("ç•™è¨€æ¿",-1)])]),_:1})]),_:1})]),o(e(oe)),o(e(O),{"as-child":""},{default:s(()=>[o(v,{to:"/user/profile",class:"px-2 py-2 hover:bg-muted rounded-md transition-colors"},{default:s(()=>[...n[22]||(n[22]=[p("ç”¨æˆ·èµ„æ–™",-1)])]),_:1})]),_:1}),o(e(O),{"as-child":""},{default:s(()=>[o(e($),{variant:"ghost",class:"w-full justify-start px-2 py-2 text-destructive hover:text-destructive hover:bg-destructive/10",onClick:S},{default:s(()=>[...n[23]||(n[23]=[p("é€€å‡ºç™»å½•",-1)])]),_:1})]),_:1})])]),_:1})]),_:1})):T("",!0)])]),n[24]||(n[24]=d("div",{class:"h-[64px] pt-[env(safe-area-inset-top)] box-content"},null,-1))],64)}}}),ea=Object.assign(Wt,{__name:"DogHeader"});export{ea as D,$ as _,Pt as a,te as b,se as c,ae as d,C as e,et as f,mt as g,Xt as h,Yt as i,ht as j,Zt as k,qt as l,Qt as m,Gt as r,Jt as u};
